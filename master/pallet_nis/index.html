<!DOCTYPE html><html lang="en"><head><link rel="canonical" href="https://paritytech.github.io/polkadot-sdk/master/pallet_nis/index.html"><meta http-equiv="refresh" content="0;URL='https://paritytech.github.io/polkadot-sdk/master/pallet_nis/index.html'"><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Non-Interactive Staking (NIS) Pallet"><title>pallet_nis - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Bold-a2c9cd1067f8b328.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../static.files/rustdoc-ba5701c5741a7b69.css" id="mainThemeStyle"><div id="rustdoc-vars" data-root-path="../" data-static-root-path="../static.files/" data-current-crate="pallet_nis" data-themes="" data-resource-suffix="" data-rustdoc-version="1.70.0 (90c541806 2023-05-31)" data-search-js="search-e077946657036a58.js" data-settings-js="settings-298e1ea74db45b39.js" data-settings-css="settings-7bfb4c59cc6bc502.css" data-theme-light-css="light-0f8c037637f9eb3e.css" data-theme-dark-css="dark-1097f8e92a01e3cf.css" data-theme-ayu-css="ayu-614652228113ac93.css" ></div><script src="../static.files/storage-62ce34ea385b278a.js"></script><script defer src="../crates.js"></script><script defer src="../static.files/main-f61008743c98d196.js"></script><noscript><link rel="stylesheet" media="(prefers-color-scheme:light)" href="../static.files/light-0f8c037637f9eb3e.css"><link rel="stylesheet" media="(prefers-color-scheme:dark)" href="../static.files/dark-1097f8e92a01e3cf.css"><link rel="stylesheet" href="../static.files/noscript-13285aec31fa243e.css"></noscript><link rel="alternate icon" type="image/png" href="../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="logo-container" href="../pallet_nis/index.html"><img class="rust-logo" src="../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2></h2></nav><nav class="sidebar"><a class="logo-container" href="../pallet_nis/index.html"><img class="rust-logo" src="../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2 class="location"><a href="#">Crate pallet_nis</a></h2><div class="sidebar-elems"><ul class="block"><li class="version">Version 4.0.0-dev</li><li><a id="all-types" href="all.html">All Items</a></li></ul><section><ul class="block"><li><a href="#modules">Modules</a></li><li><a href="#structs">Structs</a></li></ul></section></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Crate <a class="mod" href="#">pallet_nis</a><button id="copy-path" title="Copy item path to clipboard"><img src="../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="srclink" href="../src/pallet_nis/lib.rs.html#18-1140">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><h2 id="non-interactive-staking-nis-pallet"><a href="#non-interactive-staking-nis-pallet">Non-Interactive Staking (NIS) Pallet</a></h2>
<p>A pallet allowing accounts to auction for being frozen and receive open-ended
inflation-protection in return.</p>
<h3 id="overview"><a href="#overview">Overview</a></h3>
<p>Lock up tokens, for at least as long as you offer, and be free from both inflation and
intermediate reward or exchange until the tokens become unlocked.</p>
<h3 id="design"><a href="#design">Design</a></h3>
<p>Queues for each of <code>1..QueueCount</code> periods, given in blocks (<code>Period</code>). Queues are limited in
size to something sensible, <code>MaxQueueLen</code>. A secondary storage item with <code>QueueCount</code> x <code>u32</code>
elements with the number of items in each queue.</p>
<p>Queues are split into two parts. The first part is a priority queue based on bid size. The
second part is just a FIFO (the size of the second part is set with <code>FifoQueueLen</code>). Items are
always prepended so that removal is always O(1) since removal often happens many times under a
single weighed function (<code>on_initialize</code>) yet placing bids only ever happens once per weighed
function (<code>place_bid</code>). If the queue has a priority portion, then it remains sorted in order of
bid size so that smaller bids fall off as it gets too large.</p>
<p>Account may enqueue a balance with some number of <code>Period</code>s lock up, up to a maximum of
<code>QueueCount</code>. The balance gets reserved. There’s a minimum of <code>MinBid</code> to avoid dust.</p>
<p>Until your bid is consolidated and you receive a receipt, you can retract it instantly and the
funds are unreserved.</p>
<p>There’s a target proportion of effective total issuance (i.e. accounting for existing receipts)
which the pallet attempts to have frozen at any one time. It will likely be gradually increased
over time by governance.</p>
<p>As the proportion of effective total issuance represented by outstanding receipts drops below
<code>FrozenFraction</code>, then bids are taken from queues and consolidated into receipts, with the queue
of the greatest period taking priority. If the item in the queue’s locked amount is greater than
the amount remaining to achieve <code>FrozenFraction</code>, then it is split up into multiple bids and
becomes partially consolidated.</p>
<p>With the consolidation of a bid, the bid amount is taken from the owner and a receipt is issued.
The receipt records the proportion of the bid compared to effective total issuance at the time
of consolidation. The receipt has two independent elements: a “main” non-fungible receipt and
a second set of fungible “counterpart” tokens. The accounting functionality of the latter must
be provided through the <code>Counterpart</code> trait item. The main non-fungible receipt may have its
owner transferred through the pallet’s implementation of <code>nonfungible::Transfer</code>.</p>
<p>A later <code>thaw</code> function may be called in order to reduce the recorded proportion or entirely
remove the receipt in return for the appropriate proportion of the effective total issuance.
This may happen no earlier than queue’s period after the point at which the receipt was issued.
The call must be made by the owner of both the “main” non-fungible receipt and the appropriate
amount of counterpart tokens.</p>
<p><code>NoCounterpart</code> may be provided as an implementation for the counterpart token system in which
case they are completely disregarded from the thawing logic.</p>
<h3 id="terms"><a href="#terms">Terms</a></h3>
<ul>
<li><em>Effective total issuance</em>: The total issuance of balances in the system, equal to the active
issuance plus the value of all outstanding receipts, less <code>IgnoredIssuance</code>.</li>
</ul>
</div></details><h2 id="reexports" class="small-section-header"><a href="#reexports">Re-exports</a></h2><ul class="item-table"><li><div class="item-name"><code>pub use <a class="mod" href="pallet/index.html" title="mod pallet_nis::pallet">pallet</a>::*;</code></div></li></ul><h2 id="modules" class="small-section-header"><a href="#modules">Modules</a></h2><ul class="item-table"><li><div class="item-name"><a class="mod" href="pallet/index.html" title="mod pallet_nis::pallet">pallet</a></div><div class="desc docblock-short">The <code>pallet</code> module in each FRAME pallet hosts the most important items needed
to construct this pallet.</div></li><li><div class="item-name"><a class="mod" href="weights/index.html" title="mod pallet_nis::weights">weights</a></div><div class="desc docblock-short">Autogenerated weights for pallet_nis</div></li></ul><h2 id="structs" class="small-section-header"><a href="#structs">Structs</a></h2><ul class="item-table"><li><div class="item-name"><a class="struct" href="struct.NoCounterpart.html" title="struct pallet_nis::NoCounterpart">NoCounterpart</a></div></li><li><div class="item-name"><a class="struct" href="struct.WithMaximumOf.html" title="struct pallet_nis::WithMaximumOf">WithMaximumOf</a></div></li></ul></section></div></main></body></html>