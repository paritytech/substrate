<!DOCTYPE html><html lang="en"><head><link rel="canonical" href="https://paritytech.github.io/polkadot-sdk/master/sp_api/index.html"><meta http-equiv="refresh" content="0;URL='https://paritytech.github.io/polkadot-sdk/master/sp_api/index.html'"><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Substrate runtime api"><title>sp_api - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Bold-a2c9cd1067f8b328.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../static.files/rustdoc-ba5701c5741a7b69.css" id="mainThemeStyle"><div id="rustdoc-vars" data-root-path="../" data-static-root-path="../static.files/" data-current-crate="sp_api" data-themes="" data-resource-suffix="" data-rustdoc-version="1.70.0 (90c541806 2023-05-31)" data-search-js="search-e077946657036a58.js" data-settings-js="settings-298e1ea74db45b39.js" data-settings-css="settings-7bfb4c59cc6bc502.css" data-theme-light-css="light-0f8c037637f9eb3e.css" data-theme-dark-css="dark-1097f8e92a01e3cf.css" data-theme-ayu-css="ayu-614652228113ac93.css" ></div><script src="../static.files/storage-62ce34ea385b278a.js"></script><script defer src="../crates.js"></script><script defer src="../static.files/main-f61008743c98d196.js"></script><noscript><link rel="stylesheet" media="(prefers-color-scheme:light)" href="../static.files/light-0f8c037637f9eb3e.css"><link rel="stylesheet" media="(prefers-color-scheme:dark)" href="../static.files/dark-1097f8e92a01e3cf.css"><link rel="stylesheet" href="../static.files/noscript-13285aec31fa243e.css"></noscript><link rel="alternate icon" type="image/png" href="../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="logo-container" href="../sp_api/index.html"><img class="rust-logo" src="../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2></h2></nav><nav class="sidebar"><a class="logo-container" href="../sp_api/index.html"><img class="rust-logo" src="../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2 class="location"><a href="#">Crate sp_api</a></h2><div class="sidebar-elems"><ul class="block"><li class="version">Version 4.0.0-dev</li><li><a id="all-types" href="all.html">All Items</a></li></ul><section><ul class="block"><li><a href="#macros">Macros</a></li><li><a href="#structs">Structs</a></li><li><a href="#enums">Enums</a></li><li><a href="#constants">Constants</a></li><li><a href="#traits">Traits</a></li><li><a href="#functions">Functions</a></li><li><a href="#types">Type Definitions</a></li></ul></section></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Crate <a class="mod" href="#">sp_api</a><button id="copy-path" title="Copy item path to clipboard"><img src="../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="srclink" href="../src/sp_api/lib.rs.html#18-793">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Substrate runtime api</p>
<p>The Substrate runtime api is the interface between the node and the runtime. There isn’t a fixed
set of runtime apis, instead it is up to the user to declare and implement these runtime apis.
The declaration of a runtime api is normally done outside of a runtime, while the implementation
of it has to be done in the runtime. We provide the <a href="macro.decl_runtime_apis.html" title="macro sp_api::decl_runtime_apis"><code>decl_runtime_apis!</code></a> macro for declaring
a runtime api and the <a href="macro.impl_runtime_apis.html" title="macro sp_api::impl_runtime_apis"><code>impl_runtime_apis!</code></a> for implementing them. The macro docs provide more
information on how to use them and what kind of attributes we support.</p>
<p>It is required that each runtime implements at least the <a href="trait.Core.html" title="trait sp_api::Core"><code>Core</code></a> runtime api. This runtime api
provides all the core functions that Substrate expects from a runtime.</p>
<h2 id="versioning"><a href="#versioning">Versioning</a></h2>
<p>Runtime apis support versioning. Each runtime api itself has a version attached. It is also
supported to change function signatures or names in a non-breaking way. For more information on
versioning check the <a href="macro.decl_runtime_apis.html" title="macro sp_api::decl_runtime_apis"><code>decl_runtime_apis!</code></a> macro.</p>
<p>All runtime apis and their versions are returned as part of the [<code>RuntimeVersion</code>]. This can be
used to check which runtime api version is currently provided by the on-chain runtime.</p>
<h2 id="testing"><a href="#testing">Testing</a></h2>
<p>For testing we provide the <a href="macro.mock_impl_runtime_apis.html" title="macro sp_api::mock_impl_runtime_apis"><code>mock_impl_runtime_apis!</code></a> macro that lets you implement a runtime
api for a mocked object to use it in tests.</p>
<h2 id="logging"><a href="#logging">Logging</a></h2>
<p>Substrate supports logging from the runtime in native and in wasm. For that purpose it provides
the <a href="../sp_runtime/runtime_logger/struct.RuntimeLogger.html" title="struct sp_runtime::runtime_logger::RuntimeLogger"><code>RuntimeLogger</code></a>. This runtime logger is
automatically enabled for each call into the runtime through the runtime api. As logging
introduces extra code that isn’t actually required for the logic of your runtime and also
increases the final wasm blob size, it is recommended to disable the logging for on-chain
wasm blobs. This can be done by enabling the <code>disable-logging</code> feature of this crate. Be aware
that this feature instructs <code>log</code> and <code>tracing</code> to disable logging at compile time by setting
the <code>max_level_off</code> feature for these crates. So, you should not enable this feature for a
native build as otherwise the node will not output any log messages.</p>
<h2 id="how-does-it-work"><a href="#how-does-it-work">How does it work?</a></h2>
<p>Each runtime api is declared as a trait with functions. When compiled to WASM, each implemented
runtime api function is exported as a function with the following naming scheme
<code>${TRAIT_NAME}_${FUNCTION_NAME}</code>. Such a function has the following signature
<code>(ptr: *u8, length: u32) -&gt; u64</code>. It takes a pointer to an <code>u8</code> array and its length as an
argument. This <code>u8</code> array is expected to be the SCALE encoded parameters of the function as
defined in the trait. The return value is an <code>u64</code> that represents <code>length &lt;&lt; 32 | pointer</code> of
an <code>u8</code> array. This return value <code>u8</code> array contains the SCALE encoded return value as defined
by the trait function. The macros take care to encode the parameters and to decode the return
value.</p>
</div></details><h2 id="macros" class="small-section-header"><a href="#macros">Macros</a></h2><ul class="item-table"><li><div class="item-name"><a class="macro" href="macro._std_disabled.html" title="macro sp_api::_std_disabled">_std_disabled</a></div><div class="desc docblock-short">Enable/disable the given code depending on
<code>not(feature = &quot;std&quot;)</code>
being enabled for the crate or not.</div></li><li><div class="item-name"><a class="macro" href="macro._std_enabled.html" title="macro sp_api::_std_enabled">_std_enabled</a></div><div class="desc docblock-short">Enable/disable the given code depending on
<code>feature = &quot;std&quot;</code>
being enabled for the crate or not.</div></li><li><div class="item-name"><a class="macro" href="macro.decl_runtime_apis.html" title="macro sp_api::decl_runtime_apis">decl_runtime_apis</a></div><div class="desc docblock-short">Declares given traits as runtime apis.</div></li><li><div class="item-name"><a class="macro" href="macro.impl_runtime_apis.html" title="macro sp_api::impl_runtime_apis">impl_runtime_apis</a></div><div class="desc docblock-short">Tags given trait implementations as runtime apis.</div></li><li><div class="item-name"><a class="macro" href="macro.mock_impl_runtime_apis.html" title="macro sp_api::mock_impl_runtime_apis">mock_impl_runtime_apis</a></div><div class="desc docblock-short">Mocks given trait implementations as runtime apis.</div></li></ul><h2 id="structs" class="small-section-header"><a href="#structs">Structs</a></h2><ul class="item-table"><li><div class="item-name"><a class="struct" href="struct.ApiRef.html" title="struct sp_api::ApiRef">ApiRef</a></div><div class="desc docblock-short">Auxiliary wrapper that holds an api instance and binds it to the given lifetime.</div></li><li><div class="item-name"><a class="struct" href="struct.CallApiAtParams.html" title="struct sp_api::CallApiAtParams">CallApiAtParams</a></div><div class="desc docblock-short">Parameters for <a href="trait.CallApiAt.html#tymethod.call_api_at" title="method sp_api::CallApiAt::call_api_at"><code>CallApiAt::call_api_at</code></a>.</div></li></ul><h2 id="enums" class="small-section-header"><a href="#enums">Enums</a></h2><ul class="item-table"><li><div class="item-name"><a class="enum" href="enum.ApiError.html" title="enum sp_api::ApiError">ApiError</a></div><div class="desc docblock-short">An error describing which API call failed.</div></li></ul><h2 id="constants" class="small-section-header"><a href="#constants">Constants</a></h2><ul class="item-table"><li><div class="item-name"><a class="constant" href="constant.MAX_EXTRINSIC_DEPTH.html" title="constant sp_api::MAX_EXTRINSIC_DEPTH">MAX_EXTRINSIC_DEPTH</a></div><div class="desc docblock-short">Maximum nesting level for extrinsics.</div></li><li><div class="item-name"><a class="constant" href="constant.RUNTIME_API_INFO_SIZE.html" title="constant sp_api::RUNTIME_API_INFO_SIZE">RUNTIME_API_INFO_SIZE</a></div><div class="desc docblock-short">The number of bytes required to encode a <a href="trait.RuntimeApiInfo.html" title="trait sp_api::RuntimeApiInfo"><code>RuntimeApiInfo</code></a>.</div></li></ul><h2 id="traits" class="small-section-header"><a href="#traits">Traits</a></h2><ul class="item-table"><li><div class="item-name"><a class="trait" href="trait.ApiExt.html" title="trait sp_api::ApiExt">ApiExt</a></div><div class="desc docblock-short">Extends the runtime api implementation with some common functionality.</div></li><li><div class="item-name"><a class="trait" href="trait.CallApiAt.html" title="trait sp_api::CallApiAt">CallApiAt</a></div><div class="desc docblock-short">Something that can call into the an api at a given block.</div></li><li><div class="item-name"><a class="trait" href="trait.ConstructRuntimeApi.html" title="trait sp_api::ConstructRuntimeApi">ConstructRuntimeApi</a></div><div class="desc docblock-short">Something that can be constructed to a runtime api.</div></li><li><div class="item-name"><a class="trait" href="trait.Core.html" title="trait sp_api::Core">Core</a></div><div class="desc docblock-short">The <code>Core</code> runtime api that every Substrate runtime needs to implement.</div></li><li><div class="item-name"><a class="trait" href="trait.Metadata.html" title="trait sp_api::Metadata">Metadata</a></div><div class="desc docblock-short">The <code>Metadata</code> api trait that returns metadata for the runtime.</div></li><li><div class="item-name"><a class="trait" href="trait.ProvideRuntimeApi.html" title="trait sp_api::ProvideRuntimeApi">ProvideRuntimeApi</a></div><div class="desc docblock-short">Something that provides a runtime api.</div></li><li><div class="item-name"><a class="trait" href="trait.RuntimeApiInfo.html" title="trait sp_api::RuntimeApiInfo">RuntimeApiInfo</a></div><div class="desc docblock-short">Something that provides information about a runtime api.</div></li></ul><h2 id="functions" class="small-section-header"><a href="#functions">Functions</a></h2><ul class="item-table"><li><div class="item-name"><a class="fn" href="fn.deserialize_runtime_api_info.html" title="fn sp_api::deserialize_runtime_api_info">deserialize_runtime_api_info</a></div><div class="desc docblock-short">Deserialize the runtime API info serialized by <a href="fn.serialize_runtime_api_info.html" title="fn sp_api::serialize_runtime_api_info"><code>serialize_runtime_api_info</code></a>.</div></li><li><div class="item-name"><a class="fn" href="fn.init_runtime_logger.html" title="fn sp_api::init_runtime_logger">init_runtime_logger</a></div><div class="desc docblock-short">Init the <a href="../sp_runtime/runtime_logger/struct.RuntimeLogger.html" title="struct sp_runtime::runtime_logger::RuntimeLogger"><code>RuntimeLogger</code></a>.</div></li><li><div class="item-name"><a class="fn" href="fn.serialize_runtime_api_info.html" title="fn sp_api::serialize_runtime_api_info">serialize_runtime_api_info</a></div><div class="desc docblock-short">Crude and simple way to serialize the <code>RuntimeApiInfo</code> into a bunch of bytes.</div></li></ul><h2 id="types" class="small-section-header"><a href="#types">Type Definitions</a></h2><ul class="item-table"><li><div class="item-name"><a class="type" href="type.ProofRecorder.html" title="type sp_api::ProofRecorder">ProofRecorder</a></div><div class="desc docblock-short">A type that records all accessed trie nodes and generates a proof out of it.</div></li><li><div class="item-name"><a class="type" href="type.StorageChanges.html" title="type sp_api::StorageChanges">StorageChanges</a></div></li></ul></section></div></main></body></html>